Database insert failed: (psycopg2.errors.CardinalityViolation) ON CONFLICT DO UPDATE command cannot affect row a second time HINT: Ensure that no rows proposed for insertion within the same command have duplicate constrained values. [SQL: INSERT INTO egnyte_risk_stats (import_date, position, ticker_symbol, cusip, asset_class, second_level, volatility, beta, duration, notes, amended_id, source_file, source_tab, source_row) VALUES (%(import_date__0)s, %(position__0)s, %(ticker_symbol__0 ... 282630 characters truncated ... on = excluded.duration, notes = excluded.notes, amended_id = excluded.amended_id, updated_at = NOW()] [parameters: {'second_level__0': None, 'source_file__0': 'tmpa2r6uu2v.xlsx', 'asset_class__0': 'Alternatives', 'cusip__0': None, 'source_row__0': 1, 'position__0': 'Canada Funds', 'beta__0': None, 'volatility__0': None, 'notes__0': None, 'amended_id__0': None, 'source_tab__0': 'Alts', 'duration__0': None, 'ticker_symbol__0': None, 'import_date__0': datetime.date(2025, 5, 9), 'second_level__1': 'Uncorrelated Alts', 'source_file__1': 'tmpa2r6uu2v.xlsx', 'asset_class__1': 'Alternatives', 'cusip__1': None, 'source_row__1': 2, 'position__1': "FGM Alpha-F /NL/N'frac", 'beta__1': None, 'volatility__1': 10.0, 'notes__1': None, 'amended_id__1': 'FOGASAU CN EQUITY', 'source_tab__1': 'Alts', 'duration__1': None, 'ticker_symbol__1': 'FGL1030', 'import_date__1': datetime.date(2025, 5, 9), 'second_level__2': 'Uncorrelated Alts', 'source_file__2': 'tmpa2r6uu2v.xlsx', 'asset_class__2': 'Alternatives', 'cusip__2': None, 'source_row__2': 3, 'position__2': "CCL GL M/N-F /NL/N'frac", 'beta__2': -0.05761681, 'volatility__2': 10.0, 'notes__2': None, 'amended_id__2': 'CCLGMNF CN EQUITY', 'source_tab__2': 'Alts', 'duration__2': None, 'ticker_symbol__2': 'CCL876', 'import_date__2': datetime.date(2025, 5, 9), 'second_level__3': 'Uncorrelated Alts', 'source_file__3': 'tmpa2r6uu2v.xlsx', 'asset_class__3': 'Alternatives', 'cusip__3': None, 'source_row__3': 4, 'position__3': "FGL Hedge CL-Y 18 /N'frac", 'beta__3': None, 'volatility__3': 10.0 ... 13900 parameters truncated ... 'beta__996': None, 'volatility__996': None, 'notes__996': None, 'amended_id__996': '511074SY3 Muni', 'source_tab__996': 'Fixed Income', 'duration__996': None, 'ticker_symbol__996': '511074SY3', 'import_date__996': datetime.date(2025, 5, 9), 'second_level__997': 'Municipal Bonds', 'source_file__997': 'tmpa2r6uu2v.xlsx', 'asset_class__997': 'Fixed Income', 'cusip__997': None, 'source_row__997': 485, 'position__997': 'Lakewood Ohio City SCH Dist Go Ultd Tax 5.00 % Due Dec 1, 2026', 'beta__997': None, 'volatility__997': 1.0140850191516222, 'notes__997': None, 'amended_id__997': '512624RF6 Muni', 'source_tab__997': 'Fixed Income', 'duration__997': 1.0140850191516222, 'ticker_symbol__997': '512624RF6', 'import_date__997': datetime.date(2025, 5, 9), 'second_level__998': 'Municipal Bonds', 'source_file__998': 'tmpa2r6uu2v.xlsx', 'asset_class__998': 'Fixed Income', 'cusip__998': None, 'source_row__998': 486, 'position__998': 'Lancaster CNTY PA Go BDS Ser. A 4.00 % Due Nov 1, 2021', 'beta__998': None, 'volatility__998': None, 'notes__998': None, 'amended_id__998': '514040S47 Muni', 'source_tab__998': 'Fixed Income', 'duration__998': None, 'ticker_symbol__998': '514040S47', 'import_date__998': datetime.date(2025, 5, 9), 'second_level__999': 'Municipal Bonds', 'source_file__999': 'tmpa2r6uu2v.xlsx', 'asset_class__999': 'Fixed Income', 'cusip__999': None, 'source_row__999': 487, 'position__999': 'Laredo Tex Go Ref BDS Ser. 2018 5.00 % Due Feb 15, 2028', 'beta__999': None, 'volatility__999': 2.550745683385362, 'notes__999': None, 'amended_id__999': '516824GF0 Muni', 'source_tab__999': 'Fixed Income', 'duration__999': 2.550745683385362, 'ticker_symbol__999': '516824GF0', 'import_date__999': datetime.date(2025, 5, 9)}] (Background on this error at: https://sqlalche.me/e/20/f405)