<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nori Financial Portfolio Reporting</title>
    
    <!-- Fonts - Inter and JetBrains Mono -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap">
    
    <!-- Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- React and React DOM -->
    <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
    
    <!-- React Router DOM -->
    <script src="https://unpkg.com/react-router-dom@5.2.0/umd/react-router-dom.min.js" crossorigin></script>
    
    <!-- Babel for JSX with explicit non-module transform -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script>
        // Configure Babel to use non-module transform
        Babel.registerPreset('no-modules', {
            presets: [
                [Babel.availablePresets['react'], { modules: false }]
            ]
        });
    </script>
    
    <!-- XLSX for Excel export -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    
    <!-- jsPDF and AutoTable for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    
    <!-- Axios for API calls -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- We'll create a mock ChakraUI object with needed components -->
    <script>
        // Create mock ChakraUI components using Tailwind classes
        window.ChakraUI = {
            // Container components
            Box: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('div', {className: 'relative', ...props, ref}, children)),
            Container: React.forwardRef(({children, maxW, ...props}, ref) => 
                React.createElement('div', {className: 'container mx-auto px-4', ...props, ref}, children)),
            Card: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('div', {className: 'bg-white rounded-lg shadow-md p-4', ...props, ref}, children)),
            CardHeader: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('div', {className: 'border-b pb-2 mb-3', ...props, ref}, children)),
            CardBody: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('div', {...props, ref}, children)),
            
            // Typography
            Heading: React.forwardRef(({children, size, ...props}, ref) => {
                const sizes = {
                    xl: 'text-4xl',
                    lg: 'text-3xl',
                    md: 'text-2xl',
                    sm: 'text-xl',
                    xs: 'text-lg'
                };
                const className = `font-bold ${sizes[size] || 'text-2xl'}`;
                return React.createElement('h2', {className, ...props, ref}, children);
            }),
            Text: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('p', {className: 'text-gray-600', ...props, ref}, children)),
            
            // Form components
            Input: React.forwardRef(({...props}, ref) => 
                React.createElement('input', {className: 'border border-gray-300 rounded p-2 w-full', ...props, ref})),
            Select: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('select', {className: 'border border-gray-300 rounded p-2 w-full', ...props, ref}, children)),
            Button: React.forwardRef(({children, colorScheme, size, isLoading, ...props}, ref) => {
                const colors = {
                    blue: 'bg-blue-500 hover:bg-blue-600 text-white',
                    green: 'bg-green-500 hover:bg-green-600 text-white',
                    red: 'bg-red-500 hover:bg-red-600 text-white',
                    gray: 'bg-gray-200 hover:bg-gray-300 text-gray-800'
                };
                const sizes = {
                    sm: 'px-2 py-1 text-sm',
                    md: 'px-4 py-2',
                    lg: 'px-6 py-3 text-lg'
                };
                const className = `${colors[colorScheme] || colors.blue} ${sizes[size] || sizes.md} rounded font-semibold`;
                return React.createElement('button', {
                    className, 
                    disabled: isLoading,
                    ...props, 
                    ref
                }, isLoading ? [
                    React.createElement('span', {key: 'spinner', className: 'inline-block w-4 h-4 mr-2 border-2 border-white border-t-transparent rounded-full animate-spin'}),
                    children
                ] : children);
            }),
            
            // Layout components
            Flex: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('div', {className: 'flex', ...props, ref}, children)),
            HStack: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('div', {className: 'flex space-x-4', ...props, ref}, children)),
            Stack: React.forwardRef(({children, spacing, ...props}, ref) => {
                const space = spacing ? `space-y-${spacing}` : 'space-y-4';
                return React.createElement('div', {className: space, ...props, ref}, children);
            }),
            SimpleGrid: React.forwardRef(({children, columns, spacing, ...props}, ref) => {
                const cols = typeof columns === 'object' 
                    ? 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3' 
                    : `grid grid-cols-${columns || 1}`;
                const gap = spacing ? `gap-${spacing}` : 'gap-4';
                return React.createElement('div', {className: `${cols} ${gap}`, ...props, ref}, children);
            }),
            Spacer: React.forwardRef((props, ref) => 
                React.createElement('div', {className: 'flex-grow', ...props, ref})),
            
            // Form groups
            FormControl: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('div', {className: 'mb-4', ...props, ref}, children)),
            FormLabel: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('label', {className: 'block text-sm font-medium text-gray-700 mb-1', ...props, ref}, children)),
            
            // Feedback components
            Alert: React.forwardRef(({children, status, ...props}, ref) => {
                const colors = {
                    error: 'bg-red-100 text-red-800 border-red-200',
                    success: 'bg-green-100 text-green-800 border-green-200',
                    warning: 'bg-yellow-100 text-yellow-800 border-yellow-200',
                    info: 'bg-blue-100 text-blue-800 border-blue-200'
                };
                return React.createElement('div', {
                    className: `rounded-md p-4 border ${colors[status] || colors.info}`, 
                    ...props,
                    ref
                }, children);
            }),
            AlertIcon: React.forwardRef((props, ref) => 
                React.createElement('span', {className: 'mr-2', ...props, ref}, '⚠️')),
            Spinner: React.forwardRef((props, ref) => 
                React.createElement('div', {
                    className: 'inline-block w-6 h-6 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin',
                    ...props,
                    ref
                })),
            
            // Table components
            Table: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('table', {className: 'min-w-full divide-y divide-gray-200', ...props, ref}, children)),
            Thead: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('thead', {className: 'bg-gray-50', ...props, ref}, children)),
            Tbody: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('tbody', {className: 'divide-y divide-gray-200', ...props, ref}, children)),
            Tr: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('tr', props, children)),
            Th: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('th', {
                    className: 'px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider',
                    ...props,
                    ref
                }, children)),
            Td: React.forwardRef(({children, ...props}, ref) => 
                React.createElement('td', {className: 'px-6 py-4 whitespace-nowrap', ...props, ref}, children)),
            
            // Other elements
            Badge: React.forwardRef(({children, colorScheme, ...props}, ref) => {
                const colors = {
                    blue: 'bg-blue-100 text-blue-800',
                    red: 'bg-red-100 text-red-800',
                    green: 'bg-green-100 text-green-800',
                    yellow: 'bg-yellow-100 text-yellow-800',
                    orange: 'bg-orange-100 text-orange-800',
                    gray: 'bg-gray-100 text-gray-800'
                };
                return React.createElement('span', {
                    className: `inline-block px-2 py-1 text-xs font-semibold rounded-full ${colors[colorScheme] || colors.gray}`,
                    ...props,
                    ref
                }, children);
            }),
            
            // Mock hooks
            useToast: () => ({
                // Simple toast simulation function that returns an object with toast methods
                toast: (options) => {
                    console.log('Toast:', options);
                    const toastDiv = document.createElement('div');
                    toastDiv.className = 'fixed top-4 right-4 bg-gray-800 text-white p-4 rounded shadow-lg z-50';
                    toastDiv.innerHTML = `<div class="font-bold">${options.title || ''}</div><div>${options.description || ''}</div>`;
                    document.body.appendChild(toastDiv);
                    setTimeout(() => {
                        toastDiv.style.opacity = '0';
                        toastDiv.style.transition = 'opacity 0.5s';
                        setTimeout(() => toastDiv.remove(), 500);
                    }, options.duration || 3000);
                }
            })
        };
    </script>
    
    <style>
        /* Base styles */
        body {
            font-family: 'Inter', sans-serif;
            color: #1E293B;
            background-color: #F8FAFC;
        }
        
        /* Animated progress bar for background processing */
        .progress-bar-striped {
            background-image: linear-gradient(45deg, rgba(255, 255, 255, .15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, .15) 50%, rgba(255, 255, 255, .15) 75%, transparent 75%, transparent);
            background-size: 1rem 1rem;
        }
        
        .progress-bar-animated {
            animation: progress-bar-stripes 1s linear infinite;
        }
        
        @keyframes progress-bar-stripes {
            from {
                background-position: 1rem 0;
            }
            to {
                background-position: 0 0;
            }
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
        }

        code, pre {
            font-family: 'JetBrains Mono', monospace;
        }

        /* Custom colors */
        .bg-primary-green {
            background-color: #14532D;
        }

        .text-primary-green {
            color: #14532D;
        }

        .bg-secondary-navy {
            background-color: #0F172A;
        }

        .text-secondary-navy {
            color: #0F172A;
        }

        .bg-accent-green {
            background-color: #22C55E;
        }

        .text-accent-green {
            color: #22C55E;
        }

        /* Financial metrics */
        .metric-up {
            color: #10B981;
        }

        .metric-down {
            color: #EF4444;
        }

        /* Stats cards */
        .stats-card {
            transition: all 0.3s ease;
        }

        .stats-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* Chart containers */
        .chart-container {
            height: 300px;
            width: 100%;
            position: relative;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Root div for React app -->
    <div id="root"></div>
    
    <!-- Load React components with non-module preset -->
    <script type="text/babel" data-preset="no-modules" src="src/api.js"></script>
    <script type="text/babel" data-preset="no-modules" src="src/components/Chart.jsx"></script>
    <script type="text/babel" data-preset="no-modules" src="src/components/ReportTable.jsx"></script>
    <script type="text/babel" data-preset="no-modules" src="src/components/NavigationBar.jsx"></script>
    <script type="text/babel" data-preset="no-modules" src="src/components/FileUploader.jsx"></script>
    <script type="text/babel" data-preset="no-modules" src="src/components/OwnershipTree.jsx"></script>
    <script type="text/babel" data-preset="no-modules" src="src/components/OwnershipTreePage.jsx"></script>
    <script type="text/babel" data-preset="no-modules" src="src/components/SimpleOwnershipTreePage.jsx"></script>
    <script type="text/babel" data-preset="no-modules" src="src/components/PortfolioReport.jsx"></script>
    <script type="text/babel" data-preset="no-modules" src="src/pages/PortfolioReportPage.jsx"></script>
    <script type="text/babel" data-preset="no-modules" src="src/pages/ModelPortfolioPage.jsx"></script>
    <script type="text/babel" data-preset="no-modules" src="src/components/RiskStatsJobManager.jsx"></script>
    <script type="text/babel" data-preset="no-modules" src="src/pages/RiskStatsPage.jsx"></script>
    <script type="text/babel" data-preset="no-modules" src="src/components/Dashboard.jsx"></script>
    <script type="text/babel" data-preset="no-modules" src="src/App.jsx"></script>
    <script type="text/babel" data-preset="no-modules">
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
